<div class="dashboard-container">
  <div class="main-content" [class.split-view]="selectedVideo">
    <div class="videos-section">
      <div class="header">
        <h1>Video Dashboard</h1>
        <div class="header-actions">
          <div class="view-toggle">
            <button 
              class="toggle-btn" 
              [class.active]="currentView === 'videos'"
              (click)="switchView('videos')">
              Videos
            </button>
            <button 
              class="toggle-btn" 
              [class.active]="currentView === 'analytics'"
              (click)="switchView('analytics')">
              Analytics
            </button>
          </div>
          <app-video-upload (videoUploaded)="onVideoUploaded()"></app-video-upload>
        </div>
      </div>

      <!-- Videos View -->
      <div *ngIf="currentView === 'videos'">
        <div *ngIf="loading" class="loading">
          <div class="spinner"></div>
          <p>Loading videos...</p>
        </div>

        <div *ngIf="error" class="error-message">
          {{ error }}
        </div>

        <div class="videos-grid" *ngIf="!loading && !error">
        <div 
          *ngFor="let video of videos" 
          class="video-card"
          [class.selected]="selectedVideo?.id === video.id"
          (click)="selectVideo(video)">
          
          <div class="video-thumbnail">
            <div class="thumbnail-placeholder">
              <span class="video-icon">üé¨</span>
            </div>
          </div>
          
          <div class="video-info">
            <h3>{{ video.name }}</h3>
            <p class="video-meta">
              <span>FPS: {{ video.fps }}</span>
              <span *ngIf="video.created_at">
                {{ video.created_at | date:'short' }}
              </span>
            </p>
          </div>
          
          <!-- NEW: Delete Button -->
          <button 
            class="btn-delete-video"
            (click)="confirmDelete(video, $event)"
            title="Delete Video">
            üóëÔ∏è
          </button>
        </div>

        <div *ngIf="videos.length === 0" class="empty-state">
          <div class="empty-icon">üìπ</div>
          <h3>No Videos Yet</h3>
          <p>Upload your first video to get started</p>
        </div>
        </div>
      </div>
      
      <!-- Analytics View -->
      <div *ngIf="currentView === 'analytics'">
        <app-analytics-dashboard></app-analytics-dashboard>
      </div>
    </div>

    <div class="detail-panel" *ngIf="selectedVideo && currentView === 'videos'">
      <app-video-detail 
        [video]="selectedVideo"
        (close)="closeDetail()">
      </app-video-detail>
    </div>
  </div>
</div>

<!-- NEW: Delete Confirmation Modal -->
<div class="modal-overlay" *ngIf="showDeleteConfirm" (click)="cancelDelete()">
  <div class="modal-content delete-confirm" (click)="$event.stopPropagation()">
    <h3>‚ö†Ô∏è Delete Video?</h3>
    <p>Are you sure you want to delete <strong>{{ videoToDelete?.name }}</strong>?</p>
    <p class="warning-text">This action cannot be undone. The video file and all associated data will be permanently deleted.</p>
    
    <div class="modal-actions">
      <button class="btn-cancel" (click)="cancelDelete()">Cancel</button>
      <button class="btn-delete" (click)="deleteVideo()">Delete</button>
    </div>
  </div>
</div>
